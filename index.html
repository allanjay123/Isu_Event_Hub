<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISU Event Hub | Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --isu-green: #2d5a27; 
            --isu-gold: #facc15; 
            --isu-dark: #1e3d1a;
            --bg: #f4f7f6; 
            --card-bg: #ffffff; 
            --text: #333333; 
        }

        body { background: var(--bg); font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; color: var(--text); transition: 0.3s; padding-bottom: 50px; }
        
        /* HEADER - PROFESSIONAL DESIGN */
        .header { 
            background: linear-gradient(135deg, var(--isu-green), var(--isu-dark)); 
            color: white; padding: 15px 20px; 
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .header-left { display: flex; align-items: center; gap: 15px; }
        .menu-btn { font-size: 22px; cursor: pointer; transition: 0.2s; }
        .menu-btn:hover { color: var(--isu-gold); }

        .notif-wrapper { position: relative; cursor: pointer; font-size: 20px; }
        .notif-badge { 
            position: absolute; top: -5px; right: -5px; background: #ff4d4d; 
            color: white; font-size: 10px; padding: 2px 6px; border-radius: 50%; display: none; 
            border: 2px solid var(--isu-green);
        }

        /* SIDEBAR (LEFT SIDE) */
        .sidebar {
            position: fixed; top: 0; left: -280px; width: 280px; height: 100%;
            background: var(--card-bg); box-shadow: 5px 0 15px rgba(0,0,0,0.2);
            transition: 0.4s; z-index: 2000; padding-top: 60px;
        }
        .sidebar.active { left: 0; }
        .sidebar-item { 
            padding: 15px 25px; display: flex; align-items: center; gap: 15px; 
            cursor: pointer; border-bottom: 1px solid #f0f0f0; font-weight: 500;
        }
        .sidebar-item:hover { background: #f9f9f9; color: var(--isu-green); }

        .container { max-width: 1100px; margin: 25px auto; padding: 0 20px; }
        
        /* ADMIN DASHBOARD SECTION */
        .profile-card { 
            background: white; padding: 20px; border-radius: 15px; margin-bottom: 25px; 
            display: flex; align-items: center; gap: 20px; 
            border-left: 8px solid var(--isu-gold); box-shadow: 0 4px 15px rgba(0,0,0,0.05); 
        }
        #logo-preview { 
            width: 70px; height: 70px; border-radius: 50%; 
            border: 3px solid var(--isu-gold); object-fit: cover; background: #eee;
        }
        .profile-info h2 { margin: 0; font-size: 20px; color: var(--isu-green); }
        .profile-info p { margin: 5px 0; color: #666; font-size: 14px; }

        /* GRID MENU */
        .grid-main { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .box-link { 
            background: white; padding: 20px 10px; border-radius: 12px; 
            text-decoration: none; text-align: center; transition: 0.3s; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.05); border-top: 4px solid transparent;
        }
        .box-link:hover { transform: translateY(-5px); border-top: 4px solid var(--isu-gold); }
        .box-link i { font-size: 28px; color: var(--isu-green); margin-bottom: 12px; }
        .box-link span { display: block; font-weight: bold; font-size: 12px; color: #444; text-transform: uppercase; letter-spacing: 0.5px; }

        /* SECTIONS (CHART & FREEDOM WALL) */
        .flex-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .section-box { 
            background: white; padding: 20px; border-radius: 15px; 
            box-shadow: 0 6px 18px rgba(0,0,0,0.06); border-top: 3px solid var(--isu-green);
        }
        .section-title { 
            font-weight: bold; color: var(--isu-green); margin-bottom: 15px; 
            display: flex; align-items: center; gap: 10px; font-size: 16px;
            text-transform: uppercase; border-bottom: 2px solid #f4f7f6; padding-bottom: 10px;
        }

        /* FREEDOM WALL PROFESSIONAL LOOK */
        #shoutbox { 
            height: 180px; overflow-y: auto; background: #fdfdfd; 
            padding: 10px; border-radius: 8px; border: 1px solid #eee;
        }
        .shout-item { 
            background: white; padding: 10px; margin-bottom: 8px; border-radius: 6px; 
            border-left: 4px solid var(--isu-gold); box-shadow: 0 2px 4px rgba(0,0,0,0.03);
            font-size: 13px; color: #444;
        }

        /* HOTLINES */
        .emergency-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; }
        .contact-card { 
            background: #fffafa; border: 1px solid #ffebeb; padding: 15px; 
            border-radius: 10px; display: flex; align-items: center; gap: 12px; 
            transition: 0.3s;
        }
        .contact-card:hover { background: #fff1f1; }
        .contact-card i { color: #d9534f; font-size: 22px; }
        .contact-card b { display: block; color: #333; font-size: 14px; }
        .contact-card a { color: #d9534f; text-decoration: none; font-weight: bold; font-size: 13px; }
    </style>
</head>
<body>

    <div class="sidebar" id="sidebar">
        <div style="padding: 20px; text-align: right;"><i class="fas fa-times" onclick="toggleMenu()" style="cursor:pointer;"></i></div>
        <div class="sidebar-item" onclick="toggleDarkMode()"><i class="fas fa-moon"></i> <span>Dark Mode</span></div>
        <div class="sidebar-item" onclick="alert('Support: admin@isu.edu.ph')"><i class="fas fa-info-circle"></i> <span>Help & Support</span></div>
    </div>

    <div class="header">
        <div class="header-left">
            <div class="menu-btn" onclick="toggleMenu()"><i class="fas fa-bars"></i></div>
            <h1 style="font-size: 18px; margin: 0; letter-spacing: 1px;">ISU ONLINE EVENT SYSTEM</h1>
        </div>
        <div class="notif-wrapper" onclick="clearNotif()">
            <i class="fas fa-bell"></i>
            <span class="notif-badge" id="notifBadge">!</span>
        </div>
    </div>

    <div class="container">
        <div class="profile-card">
            <img id="logo-preview" src="https://via.placeholder.com/80?text=Logo" onclick="document.getElementById('image-input').click()">
            <input type="file" id="image-input" style="display:none;" onchange="previewImage(this)">
            <div class="profile-info">
                <h2 id="admin-display-name">Admin Dashboard</h2>
                <p>Isabela State University - Cabagan</p>
                <span style="color:var(--isu-green); cursor:pointer; font-size:12px; font-weight: bold;" onclick="editAdminName()"><i class="fas fa-edit"></i> Edit Admin Name</span>
            </div>
        </div>

        <div class="grid-main">
            <a href="calendar.html" class="box-link"><i class="fas fa-calendar-alt"></i><span>Calendar</span></a>
            <a href="activities.html" class="box-link"><i class="fas fa-user-edit"></i><span>Registration</span></a>
            <a href="leaderboard.html" class="box-link"><i class="fas fa-chart-line"></i><span>Leaderboard</span></a>
            <a href="voting.html" class="box-link"><i class="fas fa-vote-yea"></i><span>Voting</span></a>
            <a href="attendance.html" class="box-link"><i class="fas fa-id-card"></i><span>Attendance</span></a>
            <a href="lostfound.html" class="box-link"><i class="fas fa-box-open"></i><span>Lost & Found</span></a>
        </div>

        <div class="flex-row">
            <div class="section-box">
                <div class="section-title"><i class="fas fa-chart-bar" style="color:var(--isu-gold)"></i> Live Department Points</div>
                <div style="height: 250px;"><canvas id="scoreChart"></canvas></div>
            </div>

            <div class="section-box">
                <div class="section-title"><i class="fas fa-bullhorn" style="color:var(--isu-gold)"></i> Freedom Wall</div>
                <div id="shoutbox"></div>
                <div style="display:flex; gap:8px; margin-top:15px;">
                    <input type="text" id="shoutMsg" style="flex:1; padding:10px; border:1px solid #ddd; border-radius:6px;" placeholder="Post a cheer...">
                    <button onclick="postShout()" style="background:var(--isu-green); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:bold;">POST</button>
                </div>
            </div>
        </div>

        <div class="section-box" style="margin-top: 10px;">
            <div class="section-title"><i class="fas fa-phone-alt" style="color:#d9534f"></i> Emergency & Hotline Directory</div>
            <div class="emergency-grid">
                <div class="contact-card">
                    <i class="fas fa-ambulance"></i>
                    <div><b>Campus Clinic</b><a id="num-clinic" href="tel:09123456789">0912-345-6789</a></div>
                </div>
                <div class="contact-card">
                    <i class="fas fa-shield-alt"></i>
                    <div><b>Campus Security</b><a id="num-security" href="tel:09223334444">0922-333-4444</a></div>
                </div>
                <div class="contact-card">
                    <i class="fas fa-fire-extinguisher"></i>
                    <div><b>BFP Cabagan</b><a id="num-bfp" href="tel:117">117 / (078) 123-4567</a></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let lastShoutCount = (JSON.parse(localStorage.getItem('isuShouts')) || []).length;

        function toggleMenu() { document.getElementById('sidebar').classList.toggle('active'); }

        // --- DASHBOARD CORE LOGIC ---
        window.onload = function() {
            if(localStorage.getItem('adminName')) document.getElementById('admin-display-name').innerText = localStorage.getItem('adminName');
            if(localStorage.getItem('adminLogo')) document.getElementById('logo-preview').src = localStorage.getItem('adminLogo');
            loadShouts();
            renderChart();
        };

        function renderChart() {
            const savedData = JSON.parse(localStorage.getItem('isuLeaderboard')) || [
                { dept: 'CCSICT', score: 1200 }, { dept: 'CTE', score: 1050 },
                { dept: 'CBA', score: 900 }, { dept: 'CAES', score: 850 }
            ];
            const ctx = document.getElementById('scoreChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: savedData.map(d => d.dept),
                    datasets: [{ 
                        label: 'Points', 
                        data: savedData.map(d => d.score), 
                        backgroundColor: '#2d5a27', 
                        hoverBackgroundColor: '#facc15',
                        borderRadius: 8
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } }
                }
            });
        }

        function postShout() {
            const m = document.getElementById('shoutMsg').value;
            if(!m) return;
            let s = JSON.parse(localStorage.getItem('isuShouts')) || [];
            s.unshift({ text: m });
            localStorage.setItem('isuShouts', JSON.stringify(s));
            document.getElementById('shoutMsg').value = '';
            loadShouts();
        }

        function loadShouts() {
            const s = JSON.parse(localStorage.getItem('isuShouts')) || [];
            document.getElementById('shoutbox').innerHTML = s.map(x => `
                <div class="shout-item">
                    <b>Student:</b> ${x.text}
                </div>
            `).join('');
            if (s.length > lastShoutCount) document.getElementById('notifBadge').style.display = 'block';
        }

        function clearNotif() {
            document.getElementById('notifBadge').style.display = 'none';
            lastShoutCount = (JSON.parse(localStorage.getItem('isuShouts')) || []).length;
        }

        function editAdminName() {
            const n = prompt("Enter New Admin/Org Name:");
            if(n) { 
                document.getElementById('admin-display-name').innerText = n; 
                localStorage.setItem('adminName', n); 
            }
        }

        function previewImage(i) {
            const r = new FileReader();
            r.onload = e => { 
                document.getElementById('logo-preview').src = e.target.result; 
                localStorage.setItem('adminLogo', e.target.result); 
            }
            r.readAsDataURL(i.files[0]);
        }
    </script>
</body>
                    </html>
                    
